schemaVersion: '2.0.0'
commandTests:
  - name: 'Composer is installed'
    command: composer
    args: ['--version']
    expectedOutput: ['Composer version*']
  - name: 'PHP extensions'
    command: bash
    args:
      - -c
      - |
        php -m | grep -e json -e apcu -e curl -e elastic_apm -e gd -e mbstring -e openssl -e pdo -e redis -e "Zend OPcache" -e tokenizer -e xml -e SimpleXML -e ctype | sort -uf
    expectedOutput: ["apcu\nctype\ncurl\nelastic_apm\ngd\njson\nlibxml\nmbstring\nopenssl\npdo_mysql\nredis\nSimpleXML\ntokenizer\nxml\nxmlreader\nxmlwriter\nZend OPcache"]
  - name: 'Git is installed'
    command: which
    args: ['git']
  - name: 'Patch is installed'
    command: which
    args: ['patch']
  - name: 'MariaDB client is installed'
    command: which
    args: ['mysql']
  - name: 'Bash is installed'
    command: which
    args: ['bash']
  - name: 'JQ is installed'
    command: which
    args: ['jq']
  - name: 'make is installed'
    command: which
    args: ['make']
  - name: 'drush is installed'
    command: which
    args: ['drush']

metadataTest:
  env:
    - key: 'COMPOSER_HOME'
      value: '/.composer'

